# Лекция 1. Введение в .NET

**Цель лекции:** Сформировать у студентов целостное представление о платформе .NET, её архитектуре, ключевых компонентах и принципах работы. Объяснить, почему .NET является мощным инструментом для современной разработки.

---

### **План лекции:**

1.  **Что такое .NET?** (Общее понятие, философия)
2.  **Архитектура .NET: CLR, CTS, CLS** (Сердце платформы)
3.  **Base Class Library (BCL) и Framework Class Library (FCL)** (Библиотеки "из коробки")
4.  **Экосистема языков программирования** (C#, F#, VB.NET)
5.  **Ключевые концепции: управление памятью и сборка мусора**
6.  **Современная экосистема: .NET 5+ и .NET Core vs .NET Framework**
7.  **Что можно разрабатывать на .NET?** (Области применения)

---

### **1. Что такое .NET?**

**.NET** — это не язык программирования, а **платформа** для разработки и выполнения приложений. Это кроссплатформенная, открытая экосистема с мощной системой инструментов и библиотек.

**Ключевая философия:** "Напиши once, запускай где угодно" (хотя с некоторыми оговорками). Код, написанный на C#, может выполняться на Windows, Linux, macOS, в контейнерах Docker, на мобильных устройствах и даже на микроконтроллерах.

**Основные характеристики:**
*   **Кроссплатформенность:** Запуск на разных операционных системах.
*   **Открытый исходный код:** Исходный код .NET и многих компонентов открыт и находится на GitHub.
*   **Производительность:** Одна из самых быстрых платформ согласно многим тестам (TechEmpower).
*   **Безопасность:** Встроенные механизмы безопасности, такие как проверка типов, управление доступом для кода.
*   **Управляемый код:** Среда выполнения (CLR) управляет выполнением приложения, обеспечивая безопасность, сборку мусора и другие сервисы.

**Аналогия:** Представьте, что .NET — это **виртуальное государство** со своими законами (CLR), официальными языками (C#, F#) и огромной библиотекой готовых решений (BCL/FCL). Ваше приложение — это гражданин этого государства, который может свободно перемещаться между разными "физическими странами" (ОС), потому что везде соблюдаются законы этого виртуального государства.

---

### **2. Архитектура .NET: CLR, CTS, CLS**

Это основа основ. Понимание этих компонентов критически важно.

#### **Common Language Runtime (CLR) — Среда Выполнения**
CLR — это "виртуальная машина", которая выполняет .NET код. Это сердце платформы.

**Что делает CLR?**
1.  **Управление памятью и Сборка Мусора (Garbage Collection):** Автоматически выделяет и освобождает память.
2.  **JIT-компиляция (Just-In-Time):** Преобразует промежуточный язык (IL) в машинный код, специфичный для процессора и ОС, прямо во время выполнения. Это дает преимущества как интерпретируемых языков (переносимость), так и компилируемых (производительность).
3.  **Безопасность:** Проверяет код на корректность и безопасность типов.
4.  **Обработка исключений:** Единая система для обработки ошибок.
5.  **Управление потоками:** Позволяет создавать многопоточные приложения.

**Процесс выполнения кода:**
1.  Вы пишете код на C#.
2.  Компилятор C# компилирует его в **промежуточный язык (IL или MSIL)** и упаковывает в сборку (.dll или .exe).
3.  При запуске приложения CLR загружает сборку.
4.  **JIT-компилятор** преобразует IL в нативный (машинный) код для текущей платформы.
5.  Нативный код выполняется процессором.

#### **Common Type System (CTS) — Общая Система Типов**
CTS определяет все типы данных, которые могут быть использованы в .NET, и то, как они взаимодействуют. Это гарантирует, что тип `int` в C# и `Integer` в VB.NET — это один и тот же фундаментальный тип в памяти (`System.Int32`). Это основа для взаимодействия между языками.

**Пример:**
```csharp
// C#
int number = 10;
string text = "Hello";
```
Эквивалентно в VB.NET:
```vbnet
' VB.NET
Dim number As Integer = 10
Dim text As String = "Hello"
```
Под капотом оба этих фрагмента используют типы из CTS: `System.Int32` и `System.String`.

#### **Common Language Specification (CLS) — Общая Спецификация Языка**
CLS — это подмножество CTS. Это набор правил, которым должен следовать язык, чтобы быть совместимым с .NET. Если язык следует CLS, то библиотеки, написанные на нем, гарантированно будут работать с любым другим языком .NET.

**Пример правила CLS:** Имена методов не должны отличаться только регистром. Поэтому вы не сможете создать два публичных метода `Calculate()` и `calculate()` в одной сборке, если хотите, чтобы она была CLS-совместимой.

---

### **3. Base Class Library (BCL) и Framework Class Library (FCL)**

Это огромная коллекция готовых классов, интерфейсов и типов значений, которые значительно ускоряют разработку.

*   **Base Class Library (BCL):** Это ядро, самый фундаментальный набор библиотек. Включает:
    *   `System` (базовые типы, консоль, окружение)
    *   `System.Collections` (списки, словари)
    *   `System.IO` (работа с файлами и потоками)
    *   `System.Threading` (многопоточность)
*   **Framework Class Library (FCL):** Это более широкое понятие, включающее BCL + все остальные библиотеки для конкретных технологий (ASP.NET, WPF, Windows Forms, Entity Framework и т.д.).

**Примеры использования BCL:**
```csharp
// Работа с файлами (System.IO)
string[] lines = File.ReadAllLines("data.txt");
foreach (string line in lines)
{
    Console.WriteLine(line); // System.Console
}

// Работа с коллекциями (System.Collections.Generic)
List<string> names = new List<string> { "Alice", "Bob", "Charlie" };
names.Add("Diana");

// Работа с датами (System)
DateTime now = DateTime.Now;
TimeSpan duration = TimeSpan.FromDays(7);
DateTime nextWeek = now.Add(duration);
```

---

### **4. Экосистема языков программирования**

.NET поддерживает множество языков, но "первоклассными" гражданами являются:

1.  **C# (C-Sharp):** Основной и самый популярный язык. Объектно-ориентированный, современный, с богатым функционалом (LINQ, async/await, pattern matching). *Рекомендуется для изучения в первую очередь.*
2.  **F#:** Функциональный язык первого класса. Отлично подходит для сложных математических вычислений, анализа данных, финансовых систем.
3.  **Visual Basic .NET (VB.NET):** Более простой синтаксис, унаследованный от Visual Basic 6. Часто используется в legacy-проектах и для офисной автоматизации.

**Пример одного и того же кода на разных языках:**

*C#:*
```csharp
public class HelloWorld {
    public static void Main() {
        System.Console.WriteLine("Hello, World!");
    }
}
```
*F#:*
```fsharp
printfn "Hello, World!"
```
*VB.NET:*
```vbnet
Module HelloWorld
    Sub Main()
        Console.WriteLine("Hello, World!")
    End Sub
End Module
```
Все эти фрагменты компилируются в похожий IL-код и выполняются под управлением одной и той же CLR.

---

### **5. Ключевые концепции: управление памятью и сборка мусора**

В .NET разработчик в большинстве случаев **не управляет памятью вручную**. Этим занимается **Сборщик Мусора (Garbage Collector, GC)**.

**Как это работает?**
1.  Когда вы создаете объект с помощью `new`, CLR выделяет для него память в **Управляемой куче (Managed Heap)**.
2.  Когда память в куче заполняется или система обнаруживает нехватку памяти, запускается GC.
3.  GC проходит по всем объектам в куче и находит те, на которые больше нет ссылок в коде вашего приложения.
4.  Эти "бесхозные" объекты помечаются как мусор.
5.  Память, занятая мусором, освобождается, а "живые" объекты сдвигаются, чтобы устранить фрагментацию.

**Пример:**
```csharp
void MyMethod() {
    // В куче создается объект типа Person
    Person person1 = new Person("Alice");

    // person1 теперь ссылается на новый объект, старый объект "Alice" больше не имеет ссылок.
    person1 = new Person("Bob");

    // В этот момент GC может (но не обязан немедленно) очистить память от объекта "Alice".
}
```
**Преимущества:** Отсутствие утечек памяти (в правильно написанном коде), безопасность (невозможно обратиться к уже освобожденной памяти).
**Недостатки:** Непредсказуемость момента выполнения (хотя им можно управлять), небольшие накладные расходы.

---

### **6. Современная экосистема: .NET 5+ и .NET Core vs .NET Framework**

Важно понимать эволюцию платформы:

*   **.NET Framework (2002 г.):** Оригинальная, мощная, но **только для Windows**. Закрытый исходный код. Сейчас в режиме поддержки.
*   **.NET Core (2016 г.):** Переосмысление платформы. **Кроссплатформенный**, открытый исходный код, модульный и высокопроизводительный. Предназначен для облачных и современных приложений.
*   **.NET 5, 6, 7, 8... (2020 г. — н.в.):** **Единая платформа**. Объединяет лучшее из .NET Framework, .NET Core и Xamarin. Не имеет суффиксов "Core" или "Framework". Это будущее и настоящее .NET.

**Какую версию использовать?**
*   Для всех **новых проектов** используйте последнюю стабильную версию **.NET 8** (или новее, когда она выйдет).
*   .NET Framework используется только для поддержки старых, уже существующих приложений.

---

### **7. Что можно разрабатывать на .NET?**

Области применения невероятно широки:

1.  **Веб-приложения:**
    *   **Backend-API:** С помощью ASP.NET Core — одного из самых быстрых фреймворков в мире.
    *   **Веб-сайты (MVC, Razor Pages):** Динамические сайты с рендерингом на стороне сервера.
    *   **Blazor:** Технология для построения интерактивных веб-UI с помощью C# вместо JavaScript.
2.  **Десктопные приложения:**
    *   **Windows:** WPF, Windows Forms, WinUI 3.
    *   **Кроссплатформенные:** Avalonia UI, MAUI (.NET Multi-platform App UI).
3.  **Мобильные приложения:** С помощью .NET MAUI (для iOS и Android).
4.  **Микросервисы и облачные приложения:** Идеально подходит для Docker и Kubernetes благодаря своей модульности и производительности.
5.  **Игры:** С помощью движка Unity, который использует C# как основной язык скриптинга.
6.  **Искусственный интеллект и ML:** С помощью библиотеки ML.NET.
7.  **Интернет вещей (IoT):** .NET может работать на устройствах с ограниченными ресурсами.

---

### **Резюме**

1.  **.NET — это платформа**, а не язык. Она кроссплатформенная, открытая и высокопроизводительная.
2.  **CLR** — это "движок", который выполняет код, управляет памятью и обеспечивает безопасность.
3.  **CTS и CLS** обеспечивают межъязыковое взаимодействие.
4.  **BCL/FCL** — это огромная стандартная библиотека, которая избавляет от необходимости писать код "с нуля".
5.  **C#** — основной язык для разработки под .NET.
6.  **Сборка мусора** автоматически освобождает память, упрощая жизнь разработчика.
7.  Для новых проектов следует использовать современные версии **.NET (5+)**.
8.  На .NET можно создавать практически любой тип приложений — от веб-API и игр до мобильных и десктопных программ.

---

### **Контрольные вопросы**

1.  Дайте определение платформе .NET. Чем она отличается от языка программирования C#?
2.  Опишите процесс выполнения кода в .NET, начиная с написания на C# и заканчивая выполнением на процессоре. Какую роль в этом процессе играет JIT-компилятор?
3.  Что такое CLR и каковы её основные функции?
4.  Для чего нужны CTS и CLS? Приведите пример, иллюстрирующий их необходимость.
5.  Что такое BCL? Приведите три примера пространств имен из BCL и задачи, которые они решают.
6.  Объясните принцип работы Сборщика Мусора (Garbage Collector). Каковы его преимущества и недостатки?
7.  В чем ключевые различия между .NET Framework и современным .NET 5/6/7/8?
8.  Перечислите не менее пяти типов приложений, которые можно разрабатывать на современном .NET.
9.  *Вопрос для размышления:* Почему кроссплатформенность стала одним из ключевых факторов успеха современного .NET по сравнению с классическим .NET Framework?