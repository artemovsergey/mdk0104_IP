# Лекция 3. Условные выражения в C#

**Цель лекции:** Понять принципы работы условных выражений, изучить операторы `if-else`, `switch` и тернарный оператор, а также научиться применять их для управления потоком выполнения программы.

---

### **План лекции:**

1. **Введение. Что такое условные выражения и зачем они нужны?**
2. **Оператор `if-else`**
    * Простая форма: `if`
    * Полная форма: `if-else`
    * Цепочка условий: `else if`
    * Вложенные операторы `if`
3. **Тернарный условный оператор `? :`**
4. **Оператор выбора `switch`**
    * Классический `switch`
    * Современный `switch` (на основе выражений и с использованием `when`)
5. **Резюме**
6. **Контрольные вопросы**

---

### **1. Введение. Что такое условные выражения и зачем они нужны?**

Условные выражения — это основа любого программного обеспечения, которое должно принимать решения. Они позволяют направлять поток выполнения программы по тому или иному пути в зависимости от выполнения определенных условий.

**Аналогия из жизни:** "Если на улице дождь, то возьми зонт, иначе надень солнечные очки."

В программировании это выглядит так: "Если значение переменной `age` больше или равно 18, то разрешить доступ, иначе показать сообщение об ошибке."

Без условных выражений наши программы были бы линейными последовательностями инструкций, не способными реагировать на изменяющиеся данные или действия пользователя.

---

### **2. Оператор `if-else`**

Это самый распространенный и фундаментальный условный оператор.

#### **Простая форма: `if`**

Синтаксис:
```csharp
if (условие)
{
    // Блок кода, выполняемый, если условие истинно (true)
}
```
**Как это работает:** Вычисляется логическое выражение в скобках. Если результат `true`, выполняется блок кода внутри фигурных скобок `{}`. Если `false` — блок кода пропускается.

**Пример:**
```csharp
int temperature = 25;

if (temperature > 20)
{
    Console.WriteLine("На улице тепло. Можно идти в футболке.");
}
// Программа продолжит выполнение отсюда, независимо от результата проверки.
```

#### **Полная форма: `if-else`**

Синтаксис:
```csharp
if (условие)
{
    // Выполняется, если условие истинно (true)
}
else
{
    // Выполняется, если условие ложно (false)
}
```

**Пример:**
```csharp
int age = 16;

if (age >= 18)
{
    Console.WriteLine("Доступ разрешен.");
}
else
{
    Console.WriteLine("Доступ запрещен. Вам нет 18 лет.");
}
```

#### **Цепочка условий: `else if`**

Используется, когда нужно проверить несколько взаимоисключающих условий.

Синтаксис:
```csharp
if (условие1)
{
    // ...
}
else if (условие2)
{
    // ...
}
else if (условие3)
{
    // ...
}
else
{
    // ... (если ни одно из условий не выполнилось)
}
```

**Важно:** Выполняется **первый** блок, условие которого равно `true`. Остальные блоки цепочки пропускаются.

**Пример (оценка студента):**
```csharp
int score = 85;

if (score >= 90)
{
    Console.WriteLine("Оценка: A");
}
else if (score >= 80) // Проверяется, только если score < 90
{
    Console.WriteLine("Оценка: B"); // Выполнится этот блок
}
else if (score >= 70) // Проверяется, только если score < 80
{
    Console.WriteLine("Оценка: C");
}
else
{
    Console.WriteLine("Оценка: F (неудовлетворительно)");
}
```

#### **Вложенные операторы `if`**

Один оператор `if` может находиться внутри другого. Это позволяет создавать сложные логические конструкции.

**Пример (проверка доступа к премиум-контенту):**
```csharp
bool isRegistered = true;
string subscriptionType = "Premium";

if (isRegistered)
{
    Console.WriteLine("Добро пожаловать!");
    
    if (subscriptionType == "Premium") // Вложенное условие
    {
        Console.WriteLine("У вас есть доступ к премиум-контенту.");
    }
    else
    {
        Console.WriteLine("Для доступа к премиум-контенту оформите подписку.");
    }
}
else
{
    Console.WriteLine("Пожалуйста, зарегистрируйтесь.");
}
```

---

### **3. Тернарный условный оператор `? :`**

Это сокращенная форма оператора `if-else`, которая возвращает значение. Она идеально подходит для простых, однострочных присваиваний.

Синтаксис:
```csharp
результирующая_переменная = (условие) ? значение_если_true : значение_если_false;
```

**Сравнение с `if-else`:**
```csharp
// Подход с if-else
string message;
int number = 10;
if (number % 2 == 0)
{
    message = "Четное";
}
else
{
    message = "Нечетное";
}

// Тот же код с тернарным оператором
string message = (number % 2 == 0) ? "Четное" : "Нечетное";
```

**Еще пример (нахождение максимального числа):**
```csharp
int a = 5, b = 10;
int max = (a > b) ? a : b; // max будет равно 10
Console.WriteLine($"Максимальное число: {max}");
```

**Преимущества:** Лаконичность.
**Недостатки:** Снижает читаемость при сложных условиях или действиях.

---

### **4. Оператор выбора `switch`**

Оператор `switch` используется, когда нужно сравнить одну переменную или выражение с множеством различных значений.

#### **Классический `switch`**

Синтаксис:
```csharp
switch (выражение)
{
    case значение1:
        // Код, выполняемый если выражение == значение1
        break; // Обязательный оператор выхода
    case значение2:
        // Код, выполняемый если выражение == значение2
        break;
    // ...
    default:
        // Код, выполняемый, если ни один case не подошел (аналог else)
        break;
}
```

**Пример (обработка кода ошибки):**
```csharp
int errorCode = 404;
string errorMessage;

switch (errorCode)
{
    case 400:
        errorMessage = "Bad Request";
        break;
    case 401:
        errorMessage = "Unauthorized";
        break;
    case 403:
        errorMessage = "Forbidden";
        break;
    case 404:
        errorMessage = "Not Found"; // Выполнится этот блок
        break;
    default:
        errorMessage = "Unknown Error";
        break;
}
Console.WriteLine(errorMessage); // Выведет: Not Found
```

**Важные особенности классического `switch`:**
*   Использует оператор `break` для выхода из блока `case`.
*   Выполнение "проваливается" с одного `case` на следующий, если не стоит `break`. Иногда это используется намеренно.

**Пример с "проваливанием":**
```csharp
int dayOfWeek = 3;
string dayType;

switch (dayOfWeek)
{
    case 1:
    case 2:
    case 3:
    case 4:
    case 5:
        dayType = "Будний день";
        break;
    case 6:
    case 7:
        dayType = "Выходной день";
        break;
    default:
        dayType = "Неверный день недели";
        break;
}
```

#### **Современный `switch` (C# 8.0 и выше)**

Начиная с C# 8.0, `switch` стал более мощным и выразительным.

*   **`switch` как выражение:** Он может возвращать значение.

    **Пример:**
    ```csharp
    int errorCode = 404;
    string errorMessage = errorCode switch
    {
        400 => "Bad Request",
        401 => "Unauthorized",
        403 => "Forbidden",
        404 => "Not Found",
        _ => "Unknown Error" // _ - аналог default
    };
    Console.WriteLine(errorMessage);
    ```

*   **Сопоставление с образцом (Pattern Matching) и использование `when`:** Позволяет создавать более сложные условия внутри `case`.

    **Пример:**
    ```csharp
    object obj = 42L; // Объект типа long

    string result = obj switch
    {
        int i when i > 0 => $"Это положительное целое число: {i}",
        int i when i < 0 => $"Это отрицательное целое число: {i}",
        string s => $"Это строка: {s}",
        long l => $"Это большое целое число (long): {l}",
        null => "Объект равен null",
        _ => "Неизвестный тип объекта"
    };
    Console.WriteLine(result); // Выведет: Это большое целое число (long): 42
    ```

---

### **5. Резюме**

*   **`if-else`** — это гибкий и универсальный инструмент для любых условных проверок, от самых простых до очень сложных и вложенных.
*   **Тернарный оператор `? :`** — это компактная замена простого `if-else` при присваивании значений. Делает код короче, но может ухудшить читаемость.
*   **Классический `switch`** идеален, когда нужно выбрать один вариант из множества **конкретных значений**. Он чище и читаемее длинной цепочки `else if`.
*   **Современный `switch`** (на основе выражений) — это мощное средство, которое не только выбирает варианты, но и **возвращает значение**, а также поддерживает сложные паттерны сопоставления, что делает код еще более декларативным и безопасным.

**Ключевой принцип выбора:** Выбирайте тот инструмент, который делает ваш код наиболее понятным и простым для чтения в конкретной ситуации.

---

### **6. Контрольные вопросы**

1.  В чем основное различие между операторами `if` и `if-else`?
2.  Объясните, как работает цепочка `else if`. Что произойдет, если в такой цепочке несколько условий окажутся истинными?
3.  В какой ситуации использование тернарного оператора предпочтительнее использования `if-else`? Приведите пример.
4.  Каково основное предназначение оператора `switch`? В каких случаях его использование более уместно, чем `if-else`?
5.  Чем современный `switch` (на основе выражений) отличается от классического? Назовите至少 два отличия.
6.  Обязателен ли блок `default` в операторе `switch`? Объясните его назначение.
7.  В чем заключается ошибка в данном коде?
    ```csharp
    int x = 5;
    if (x = 10) // Ошибка здесь
    {
        Console.WriteLine("x равно 10");
    }
    ```
    *Как ее исправить?*
8.  Напишите фрагмент кода, который использует `switch` для определения времени суток (утро, день, вечер, ночь) по целочисленной переменной `hour` (0-23).
9.  Перепишите следующий код с `if-else` на тернарный оператор:
    ```csharp
    double discount;
    double price = 1000;
    if (price > 500)
    {
        discount = price * 0.1;
    }
    else
    {
        discount = 0;
    }
    ```
10. Как с помощью паттернов в современном `switch` можно обработать ситуацию, когда объект является строкой длиной более 10 символов? Напишите пример `case`.