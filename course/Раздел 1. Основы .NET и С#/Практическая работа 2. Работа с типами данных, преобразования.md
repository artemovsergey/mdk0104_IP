# Практическая работа 2. Работа с типами данных и преобразованиями в .NET

**Тема:** Система типов в .NET. Неявная и явная бинарная трансформация. Упаковка и распаковка. Использование класса `Convert` и методов `Parse`, `TryParse`.

**Цель:** Сформировать практические навыки работы с различными типами данных в C#, освоить механизмы преобразования типов и научиться обрабатывать исключения, связанные с некорректными преобразованиями.

**Задачи:**
1. Закрепить понимание различий между значимыми (value types) и ссылочными (reference types) типами.
2. Научиться выполнять неявные и явные преобразования (casting).
3. Освоить работу с методами преобразования строк: `Parse()`, `TryParse()`.
4. Научиться использовать класс `Convert` для стандартных преобразований.
5. Понять на практике процесс упаковки (boxing) и распаковки (unboxing).
6. Научиться обрабатывать исключения `FormatException`, `InvalidCastException`, `OverflowException`.

**Ход работы:**
1. Ознакомиться с теоретическим материалом.
2. Получить вариант задания у преподавателя.
3. Разработать консольное приложение на C# по заданию.
4. Реализовать код, строго соответствующий пунктам задания.
5. Протестировать приложение с различными входными данными, включая некорректные.
6. Оформить отчет в `README.md` по заданной структуре.
7. Загрузить проект в репозиторий Git.

**Критерии оценки:**
*   **Отлично (5):** Все пункты задания выполнены полностью. Код чистый, хорошо откомментирован. Используются все требуемые механизмы преобразований (`TryParse`, `Convert`, явное/неявное приведение). Реализована корректная обработка исключений. Репозиторий оформлен по стандарту.
*   **Хорошо (4):** Задание выполнено, но есть незначительные недочеты (например, не для всех некорректных данных реализована обработка, или код недостаточно откомментирован).
*   **Удовлетворительно (3):** Основная функциональность реализована, но отсутствует обработка исключений или не все пункты задания выполнены.
*   **Неудовлетворительно (2):** Задание не выполнено или выполнено фрагментарно.

**Контрольные вопросы:**
1. Чем отличается неявное преобразование типов от явного? В каких случаях они применяются?
2. Что произойдет, если попытаться выполнить явное преобразование `long l = 500; byte b = (byte)l;` при значении `l = 500`? А при `l=100`?
3. В чем разница между методами `int.Parse()` и `int.TryParse()`? Какой метод предпочтительнее и почему?
4. Для чего предназначен класс `System.Convert`? Назовите его наиболее часто используемые методы.
5. Что такое упаковка и распаковка? Каковы их производительные издержки?
6. Какие исключения могут возникнуть при преобразовании типов и как их обработать?

---

### **15 Вариантов Практических Заданий**

**Вариант 1: Калькулятор площади геометрических фигур**
*Задание:*
Напишите программу, которая запрашивает у пользователя радиус круга (вещественное число). Программа должна вычислять и выводить площадь круга по формуле `S = π * r^2`. Реализуйте ввод данных с помощью `double.TryParse()`. Если ввод некорректен, выведите сообщение об ошибке. Результат выведите в виде целого числа (явное приведение) и в виде вещественного числа с двумя знаками после запятой.

**Вариант 2: Конвертер валют**
*Задание:*
Напишите программу для конвертации суммы из долларов (USD) в евро (EUR). Курс конвертации храните как константу с типом `decimal`. Пользователь вводит сумму в долларах (целое число). Программа должна использовать `int.TryParse()` для обработки ввода. Результат выведите в формате: `[Сумма USD] долларов = [Сумма EUR] евро`. Выполните явное приведение результата к типу `float` и выведите его тоже.

**Вариант 3: Система подсчета очков**
*Задание:*
Пользователь последовательно вводит три целых числа (очки за три уровня игры). Используйте `Convert.ToInt32()` для преобразования введенных строк. Программа должна вычислять общее количество очков и средний балл (вещественное число). Продемонстрируйте упаковку общего количества очков (тип `int`) в объект типа `object` и последующую распаковку обратно в `int` перед выводом на экран.

**Вариант 4: Генератор случайного пароля**
*Задание:*
Напишите программу, которая генерирует "случайный" PIN-код из 4 цифр. Используйте класс `Random` для генерации числа от 0 до 9999, затем приведите его к строке и дополните нулями слева до 4 символов (метод `ToString("D4")`). Продемонстрируйте неявное преобразование при работе с генератором и явное при выводе номера.

**Вариант 5: Анализатор строки**
*Задание:*
Пользователь вводит строку. Программа должна попытаться преобразовать эту строку в числа типов `int`, `double` и `decimal` с использованием соответствующих методов `TryParse()`. Выведите результат каждого преобразования (удалось/не удалось). Если преобразование в `int` удалось, выполните неявное преобразование этого числа в `long`.

**Вариант 6: Калькулятор ИМТ (Индекс Массы Тела)**
*Задание:*
Запросите у пользователя рост (в метрах, например, 1.75) и вес (в килограммах, целое число). Используйте соответствующие методы `TryParse()`. Рассчитайте ИМТ по формуле: `вес / (рост * рост)`. Результат выведите как вещественное число. Выполните явное приведение результата к типу `int` и объясните (в комментарии), что означает эта операция в контексте ИМТ.

**Вариант 7: Проверка числа на четность**
*Задание:*
Напишите программу, которая использует `byte.TryParse()` для ввода числа. Если ввод корректен, программа должна определить, является ли число четным. Результат (true/false) упакуйте в тип `object` и затем распакуйте обратно в `bool` для вывода на экран. Обработайте случай, если введенное число не помещается в диапазон типа `byte`.

**Вариант 8: Конвертер времени**
*Задание:*
Пользователь вводит количество минут (целое число). Программа должна конвертировать минуты в полные часы и оставшиеся минуты (например, 125 минут = 2 часа 5 минут). Используйте деление нацело и остаток от деления. Продемонстрируйте неявное преобразование при вычислениях. Результат выведите в виде строки.

**Вариант 9: Случайный выбор победителя**
*Задание:*
В программе жестко закодирован массив строк с именами участников. Используйте `Random` для выбора случайного победителя (генерируйте случайный индекс в диапазоне массива). Продемонстрируйте явное приведение типа при получении индекса из генератора. Выведите имя победителя.

**Вариант 10: Расчет стоимости покупки**
*Задание:*
Пользователь вводит цену товара (вещественное число) и количество единиц (целое число). Используйте `decimal` для точного расчета общей стоимости. Преобразуйте общую стоимость к типу `double` (явное приведение) и выведите оба значения. Объясните (в комментарии), почему для финансовых расчетов предпочтительнее `decimal`.

**Вариант 11: Шифратор простой замены**
*Задание:*
Пользователь вводит один символ. Программа должна преобразовать этот символ в его ASCII-код (числовое значение типа `int`), прибавить к этому коду число 1, а затем преобразовать полученное число обратно в символ. Используйте явное приведение типов `char` к `int` и обратно. Выведите исходный символ, его код и новый символ.

**Вариант 12: Проверка делимости**
*Задание:*
Пользователь вводит два целых числа. Используйте `long.TryParse()` для ввода. Программа должна проверять, делится ли первое число на второе нацело. Результат проверки (булево значение) преобразуйте в целое число (используя `Convert.ToInt32`) и выведите его (1 - если делится, 0 - если нет). Обработайте исключение `DivideByZeroException`.

**Вариант 13: Извлечение цифр из числа**
*Задание:*
Пользователь вводит трехзначное целое число. Используйте `int.Parse()` и обработайте возможные исключения. Программа должна извлекать и выводить отдельно сотни, десятки и единицы из этого числа. Используйте деление нацело и остаток от деления. Продемонстрируйте неявное преобразование в вычислениях.

**Вариант 14: Сравнение производительности**
*Задание:*
Напишите программу, которая в цикле выполняет 10000 операций упаковки и распаковки целого числа, замеряя время выполнения (используйте `System.Diagnostics.Stopwatch`). Затем выполните 10000 операций простого присваивания этого же числа. Выведите затраченное время в миллисекундах для обоих случаев. Сделайте вывод о производительности.

**Вариант 15: Универсальный преобразователь**
*Задание:*
Напишите программу, которая запрашивает у пользователя строку и целевой тип (`"int"`, `"double"`, `"bool"`). На основе введенного типа, программа должна пытаться преобразовать строку в этот тип, используя методы класса `Convert`. Обработайте все возможные исключения (`FormatException`, `OverflowException` и т.д.) и выводите информативное сообщение об ошибке. В случае успеха выведите преобразованное значение.

---

### **Пример структуры репозитория и файла README.md**

```
PracticalWork1_Types/
├── .gitignore
├── README.md
├── Images/
│   ├── result1.png
│   └── result2.png
└── TypeConverter/
    ├── TypeConverter.csproj
    ├── Program.cs
    └── ... (other project files)
```

**Содержание файла `README.md` для Варианта 1:**

```markdown
# Практическая работа №1
## Вариант 1: Калькулятор площади круга

**Задание:**
Написать программу, которая запрашивает у пользователя радиус круга, вычисляет и выводит площадь круга. Реализовать ввод с помощью `double.TryParse()`. Результат вывести в виде целого числа и в виде вещественного числа с двумя знаками после запятой.

**Код решения (Program.cs):**

```csharp
using System;

namespace TypeConverter
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("Введите радиус круга:");
            string input = Console.ReadLine();

            // Использование double.TryParse() для безопасного ввода
            if (double.TryParse(input, out double radius))
            {
                // Проверка на неотрицательность радиуса
                if (radius >= 0)
                {
                    const double pi = Math.PI;
                    double areaDouble = pi * Math.Pow(radius, 2);

                    // Явное приведение к целому типу
                    int areaInt = (int)areaDouble;

                    // Вывод результатов
                    Console.WriteLine($"Площадь круга (как целое число): {areaInt}");
                    Console.WriteLine($"Площадь круга (с точностью до 2-х знаков): {areaDouble:F2}");
                }
                else
                {
                    Console.WriteLine("Ошибка: Радиус не может быть отрицательным.");
                }
            }
            else
            {
                Console.WriteLine("Ошибка: Введено некорректное число.");
            }

            Console.ReadLine();
        }
    }
}
```

**Скриншоты результатов:**

*Рисунок 1: Корректный ввод данных*
![Результат 1](Images/result1.png)

*Рисунок 2: Обработка некорректного ввода*
![Результат 2](Images/result2.png)
```