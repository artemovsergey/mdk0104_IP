# Практическая работа 5. Основы LINQ to Objects

#### **Тема**
Работа с LINQ to Objects для обработки коллекций данных в C#.

#### **Цель**
Сформировать умения и навыки применения операторов LINQ (как в синтаксисе запросов, так и в синтаксисе методов) для фильтрации, сортировки, проекции и агрегации данных в коллекциях.

#### **Задачи**
1.  Освоить создание и инициализацию тестовых коллекций данных.
2.  Научиться писать LINQ-запросы для фильтрации данных (оператор `where`).
3.  Научиться сортировать результаты с использованием `orderby`.
4.  Освоить проекцию данных для создания новых результирующих объектов (оператор `select`).
5.  Познакомиться с группировкой данных (оператор `group by`).
6.  Научиться использовать агрегирующие операции (такие как `Count`, `Sum`, `Average`, `Max`, `Min`).
7.  Понять разницу между немедленным и отложенным выполнением запросов.

---

### **Ход работы**

**1. Подготовка окружения**
*   Создайте новое консольное приложение .NET (Console App) с именем `LinqPractice`.
*   Организуйте структуру папок в соответствии с требованиями.
*   Создайте класс `Employee` для представления сущности "Сотрудник".

**2. Заполнение тестовыми данными**
*   В методе `Main` создайте и заполните список (`List<Employee>`) тестовыми данными (10-15 сотрудников).

**3. Выполнение заданий**
*   Для каждого из 15 вариантов напишите LINQ-запрос, решающий поставленную задачу.
*   Реализуйте каждый запрос **двумя способами**: используя **синтаксис методов расширения** и **синтаксис запросов**.
*   Результаты каждого запроса выводите в консоль в читаемом формате.

---

### **Пример выполнения (для всех вариантов)**

**1. Создание класса сущности**

```csharp
public class Employee
{
    public int Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public int Age { get; set; }
    public string Department { get; set; }
    public decimal Salary { get; set; }
}
```

**2. Заполнение тестовыми данными в `Program.cs`**

```csharp
using System;
using System.Collections.Generic;
using System.Linq;

public class Program
{
    public static void Main()
    {
        List<Employee> employees = new List<Employee>
        {
            new Employee { Id = 1, FirstName = "Ivan", LastName = "Ivanov", Age = 30, Department = "IT", Salary = 50000 },
            new Employee { Id = 2, FirstName = "Petr", LastName = "Petrov", Age = 25, Department = "HR", Salary = 40000 },
            new Employee { Id = 3, FirstName = "Maria", LastName = "Sidorova", Age = 35, Department = "Finance", Salary = 60000 },
            new Employee { Id = 4, FirstName = "Anna", LastName = "Kuznetsova", Age = 28, Department = "IT", Salary = 55000 },
            new Employee { Id = 5, FirstName = "Alexey", LastName = "Smirnov", Age = 40, Department = "Finance", Salary = 70000 },
            // ... добавьте еще 5-10 сотрудников для разнообразия
        };

        // ========== ВАРИАНТЫ ЗАПРОСОВ БУДУТ ЗДЕСЬ ==========
    }
}
```

**3. Пример запроса для варианта №1**

```csharp
// Задание: Вывести всех сотрудников старше 30 лет, отсортированных по фамилии.

// Способ 1: Синтаксис методов расширения
var result1 = employees
    .Where(e => e.Age > 30)
    .OrderBy(e => e.LastName)
    .ToList();

Console.WriteLine("Синтаксис методов расширения:");
foreach (var emp in result1)
{
    Console.WriteLine($"{emp.LastName} {emp.FirstName}, Возраст: {emp.Age}");
}

Console.WriteLine();

// Способ 2: Синтаксис запросов
var result2 = from e in employees
              where e.Age > 30
              orderby e.LastName
              select e;

Console.WriteLine("Синтаксис запросов:");
foreach (var emp in result2)
{
    Console.WriteLine($"{emp.LastName} {emp.FirstName}, Возраст: {emp.Age}");
}
```

---

### **15 Вариантов заданий**

**Вариант 1:** Вывести всех сотрудников IT-отдела, отсортированных по убыванию зарплаты.

**Вариант 2:** Найти сотрудника с максимальной зарплатой во всем отделе Finance.

**Вариант 3:** Сгруппировать сотрудников по отделам и вывести для каждого отдела количество сотрудников и среднюю зарплату.

**Вариант 4:** Вывести список всех отделов (уникальные названия), в которых работают сотрудники.

**Вариант 5:** Вывести ФИО (одной строкой) и зарплату 3-x самых высокооплачиваемых сотрудников.

**Вариант 6:** Проверить, есть ли в компании сотрудники младше 22 лет. (Вернуть true/false).

**Вариант 7:** Вывести сотрудников, чья фамилия начинается на букву 'S', отсортированных по возрасту (по возрастанию).

**Вариант 8:** Вычислить общий фонд заработной платы для каждого отдела.

**Вариант 9:** Вывести сотрудников, чья зарплата находится в диапазоне от 45000 до 60000, отсортированных по Id.

**Вариант 10:** Найти самого молодого сотрудника в компании и вывести его данные.

**Вариант 11:** Вывести для каждого отдела список сотрудников (ФИО) в алфавитном порядке.

**Вариант 12:** Вывести сотрудников, у которых длина имени больше 4 букв. Спроецировать результат в анонимный тип, содержащий только Id и полное имя.

**Вариант 13:** Используя `Skip` и `Take`, реализовать постраничный вывод сотрудников (по 3 сотрудника на страницу). Вывести 2-ю страницу.

**Вариант 14:** Найти все отделы, в которых средний возраст сотрудников превышает 32 года.

**Вариант 15:** Объединить два списка сотрудников (основной и, например, список стажеров) и вывести общий отсортированный список по фамилии.

---

### **Критерии оценки**

| Критерий | Максимальный балл | Описание |
| :--- | :--- | :--- |
| **Корректность кода** | 3 | Код компилируется без ошибок, выдает точный и правильный результат для всех заданий. |
| **Полнота выполнения** | 3 | Выполнены все 15 вариантов. Каждое задание реализовано двумя способами (синтаксис методов и запросов). |
| **Чистота и стиль кода** | 2 | Код хорошо отформатирован, используются понятные имена переменных, соблюдаются стандарты C#. |
| **Структура проекта** | 1 | Соблюдена требуемая структура репозитория (папки, файлы `.gitignore`, `README.md`). |
| **Работа с Git** | 1 | Наличие осмысленных коммитов, отражающих этапы работы. |
| **Итого** | 10 | |

*   **На "отлично" (9-10 баллов):** Полное соответствие всем критериям.
*   **На "хорошо" (7-8 баллов):** Незначительные ошибки в 1-2 заданиях или неполное выполнение (например, один способ вместо двух для некоторых заданий).
*   **На "удовлетворительно" (5-6 баллов):** Выполнена большая часть работы, но с существенными ошибками или пропусками.
*   **Неудовлетворительно (<5 баллов):** Работа не выполнена или содержит критические ошибки.

---

### **Контрольные вопросы**

1.  В чем основное отличие LINQ to Objects от LINQ to SQL или LINQ to Entities?
2.  Объясните разницу между отложенным (deferred) и немедленным (immediate) выполнением LINQ-запросов. Какие операторы вызывают немедленное выполнение?
3.  В чем разница между операторами `First()` и `FirstOrDefault()`? В каких ситуациях следует использовать каждый из них?
4.  Как оператор `Select` позволяет преобразовывать (проецировать) данные? Что такое анонимные типы и для чего они используются в LINQ?
5.  Опишите, как работает оператор `GroupBy`. Что представляет собой результат группировки?
6.  Для чего используются ключевые слова `let` и `into` в синтаксисе запросов? Приведите пример.
7.  Что такое лямбда-выражение и какова его роль в синтаксисе методов расширения LINQ?
8.  Как можно комбинировать результаты из разных коллекций с помощью операторов `Join` и `GroupJoin`?

---

### **Структура репозитория и файлы**

```
LinqPracticeRepository/
├── .gitignore
├── README.md
├── images/
│   ├── example_output_1.png
│   ├── example_output_2.png
│   └── ...
└── LinqPractice/
    ├── LinqPractice.csproj
    ├── Program.cs
    └── Employee.cs
```

**Содержимое файлов:**

**1. `.gitignore`** (стандартный для .NET, можно сгенерировать или взять с GitHub)
```
**/bin/
**/obj/
```

**2. `README.md`**
```markdown
# Практическая работа по LINQ

## Тема
Работа с LINQ to Objects для обработки коллекций данных в C#.

## Описание
Этот проект содержит решения 15 практических заданий по LINQ, реализованных с использованием синтаксиса методов расширения и синтаксиса запросов.

## Структура проекта
- `Employee.cs` - Класс сущности "Сотрудник".
- `Program.cs` - Основной код с тестовыми данными и LINQ-запросами.
- `/images` - Скриншоты с примерами выполнения программы.

## Как запустить
1. Убедитесь, что установлен .NET SDK.
2. Клонируйте репозиторий.
3. Перейдите в папку `LinqPractice`.
4. Выполните в терминале: `dotnet run`.

## Автор
[Ваше Имя]
```

**3. `LinqPractice.csproj`**
```xml
<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <OutputType>Exe</OutputType>
    <TargetFramework>net6.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
  </PropertyGroup>

</Project>
```

**4. `Employee.cs`** и **5. `Program.cs`** - коды приведены выше в примере выполнения.