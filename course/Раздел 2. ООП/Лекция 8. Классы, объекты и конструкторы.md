# Лекция 8. Классы, объекты и конструкторы

**Цель лекции:** Понять фундаментальные концепции объектно-ориентированного программирования (ООП) в C#: что такое класс, как создавать объекты и для чего нужны конструкторы. Научиться создавать свои собственные типы данных.

---

### **План лекции:**

1.  **Введение в ООП.** Откуда появилась необходимость в классах?
2.  **Класс (Class).** Что такое класс? Синтаксис объявления. Поля и методы.
3.  **Объект (Object).** Что такое объект? Создание экземпляра класса. Оператор `new`.
4.  **Конструктор (Constructor).**
    *   Что такое конструктор и зачем он нужен?
    *   Конструктор по умолчанию.
    *   Параметризированный конструктор.
    *   Статический конструктор.
5.  **Инициализаторы объектов.** Краткий синтаксис для создания объектов.
6.  **Резюме.**
7.  **Контрольные вопросы.**

---

### **1. Введение в ООП**

До появления ООП программирование часто было процедурным (например, на языке C). Код и данные были разделены. Программа представляла собой набор функций, которые работали с общими структурами данных.

**Проблема:** С ростом сложности программ управление таким кодом становилось тяжелым. Изменение одной структуры данных могло привести к необходимости правок в десятках функций.

**Решение:** Объектно-Ориентированное Программирование. ООП объединяет данные и методы для работы с этими данными в одну сущность — **объект**. Это как чертеж (`класс`) и дом (`объект`). Вы создаете чертеж один раз, а по нему можете построить множество домов.

**Основные концепции ООП:** Инкапсуляция, Наследование, Полиморфизм. Сегодня мы фокусируемся на первом шаге — **Инкапсуляции** — с помощью классов.

### **2. Класс (Class)**

**Класс** — это определяемый пользователем тип данных, который выступает в роли "чертежа" или "описания" для будущих объектов.

*   **Класс описывает:**
    *   **Данные (Состояние):** Какими свойствами/характеристиками будет обладать объект. В C# для этого используются **поля (fields)** и **свойства (properties)**.
    *   **Поведение (Методы):** Что объект может делать? Какие операции можно выполнять с его данными? Для этого используются **методы (methods)**.

**Синтаксис объявления класса:**

```csharp
public class ClassName
{
    // Поля (Fields) - хранят данные объекта.
    // Обычно объявляются с модификатором private.
    private string _name;
    private int _age;

    // Свойства (Properties) - обеспечивают контролируемый доступ к полям.
    public string Name
    {
        get { return _name; }
        set { _name = value; }
    }

    public int Age
    {
        get { return _age; }
        set { _age = value; }
    }

    // Методы (Methods) - определяют поведение.
    public void IntroduceYourself()
    {
        Console.WriteLine($"Привет, меня зовут {Name} и мне {Age} лет.");
    }
}
```

**Разберем пример `Person`:**

```csharp
public class Person
{
    // Поля (обычно private, "спрятаны" внутри класса)
    private string name;
    private DateTime birthDate;

    // Свойства (обычно public, это "интерфейс" для работы с объектом)
    public string Name
    {
        get { return name; } // Get - позволяет прочитать значение
        set { name = value; } // Set - позволяет установить значение
    }

    // Метод
    public void PrintInfo()
    {
        Console.WriteLine($"Имя: {Name}, Дата рождения: {birthDate.ToShortDateString()}");
    }
}
```

> **Важно:** На практике для простых данных часто используют **автоматические свойства**: `public string Name { get; set; }`. Компилятор сам создаст скрытое приватное поле для него.

### **3. Объект (Object)**

**Объект (или экземпляр класса)** — это конкретная реализация класса, созданная в памяти во время выполнения программы. Если класс — это чертеж автомобиля, то объекты — это конкретные автомобили, стоящие на парковке, каждый со своим уникальным цветом, номером и уровнем топлива.

**Создание объекта (экземпляра класса):**

Для создания объекта используется ключевое слово `new`.

```csharp
// Синтаксис: ClassName objectName = new ClassName();
Person person1 = new Person(); // person1 - это объект (экземпляр) класса Person
```

В этот момент в управляемой куче (managed heap) выделяется память для всех полей объекта, и ссылка на эту область памяти сохраняется в переменной `person1`.

**Работа с объектом:**

После создания мы можем использовать его свойства и методы через оператор точки (`.`).

```csharp
// Создаем два объекта
Person alice = new Person();
Person bob = new Person();

// Работаем с каждым объектом независимо
alice.Name = "Алиса"; // Устанавливаем свойство Name для объекта alice
bob.Name = "Боб";     // Устанавливаем свойство Name для объекта bob

alice.PrintInfo(); // Вывод: Имя: Алиса, Дата рождения: 01.01.0001
bob.PrintInfo();   // Вывод: Имя: Боб, Дата рождения: 01.01.0001
```

Обратите внимание, что `alice` и `bob` — это два независимых объекта одного и того же класса. Изменение одного не влияет на другой.

### **4. Конструктор (Constructor)**

**Конструктор** — это специальный метод класса, который автоматически вызывается при создании объекта оператором `new`. Его основная задача — **инициализировать поля нового объекта**.

**Особенности конструктора:**
*   Имя конструктора всегда совпадает с именем класса.
*   Конструктор не имеет возвращаемого типа (даже `void`).

#### **4.1. Конструктор по умолчанию**

Если вы не написали ни одного конструктора, компилятор C# автоматически предоставляет пустой **конструктор по умолчанию (default constructor)**.

```csharp
// Это конструктор по умолчанию, который предоставил компилятор.
// Он не принимает аргументов и инициализирует поля значениями по умолчанию
// (например, 0 для чисел, null для ссылочных типов).
public Person()
{
}
```
Именно его мы использовали, когда писали `new Person()`.

#### **4.2. Параметризированный конструктор**

Часто бывает неудобно создавать объект, а потом отдельно заполнять его свойства. Параметризированный конструктор позволяет передавать начальные значения прямо при создании.

```csharp
public class Person
{
    public string Name { get; set; }
    public int Age { get; set; }

    // Параметризированный конструктор
    public Person(string personName, int personAge)
    {
        // Проверка входных данных (важная часть работы конструктора!)
        if (string.IsNullOrWhiteSpace(personName))
            throw new ArgumentException("Имя не может быть пустым");

        if (personAge < 0)
            throw new ArgumentException("Возраст не может быть отрицательным");

        Name = personName;
        Age = personAge;
    }

    public void IntroduceYourself()
    {
        Console.WriteLine($"Я {Name}, мне {Age} лет.");
    }
}

// Использование:
// Person p = new Person(); // Так теперь НЕ СКОМПИЛИРУЕТСЯ, т.к. мы определили свой конструктор, а по умолчанию удалился.
Person alice = new Person("Алиса", 25); // Сразу создаем объект с данными
alice.IntroduceYourself(); // Вывод: Я Алиса, мне 25 лет.
```

#### **4.3. Статический конструктор**

**Статический конструктор** используется для инициализации **статических** данных класса (тех, что принадлежат самому классу, а не конкретному объекту). Он выполняется только один раз, при первом обращении к классу.

```csharp
public class Settings
{
    public static string AppName;
    public static string Version;

    // Статический конструктор
    static Settings()
    {
        AppName = "My Super App";
        Version = "1.0.0";
        Console.WriteLine("Статический конструктор Settings вызван.");
    }

    // Обычный конструктор
    public Settings()
    {
        Console.WriteLine("Обычный конструктор Settings вызван.");
    }
}

// Использование:
Console.WriteLine(Settings.AppName); // Первое обращение к классу -> вызовется статический конструктор.
// В консоль выведется: "Статический конструктор Settings вызван."
// А затем: "My Super App"

Settings s1 = new Settings(); // Вызовется обычный конструктор.
// В консоль выведется: "Обычный конструктор Settings вызван."
```

### **5. Инициализаторы объектов**

C# предоставляет удобный сокращенный синтаксис для инициализации свойств объекта сразу после его создания.

**Сравним:**

```csharp
// Старый способ (без инициализатора)
Person person = new Person();
person.Name = "Карл";
person.Age = 30;

// Новый способ (с инициализатором объекта)
Person person = new Person { Name = "Карл", Age = 30 };
```
Этот код делает то же самое: создает объект и присваивает значения его свойствам. Это особенно удобно, когда у класса много свойств.

**Инициализаторы можно комбинировать с конструкторами:**
```csharp
// Сначала вызовется конструктор с параметром "Боб", а затем свойству Age присвоится значение 35.
Person person = new Person("Боб") { Age = 35 };
```

---

### **6. Резюме**

*   **Класс** — это чертеж или описание для объектов. Он определяет, какие данные (поля, свойства) и поведение (методы) будут у объектов.
*   **Объект** — это экземпляр класса, созданный в памяти во время выполнения программы. Объекты создаются с помощью оператора `new`.
*   **Конструктор** — это специальный метод, который инициализирует новый объект. Он называется так же, как и класс.
    *   **Конструктор по умолчанию** не имеет параметров.
    *   **Параметризированный конструктор** позволяет передавать начальные значения.
    *   **Статический конструктор** инициализирует статические данные класса один раз за время работы программы.
*   **Инициализаторы объектов** предоставляют лаконичный синтаксис для установки свойств сразу после создания объекта.

---

### **7. Контрольные вопросы**

1.  В чем основная разница между классом и объектом? Приведите аналогию.
2.  Что такое поле класса и чем оно отличается от свойства? Когда стоит использовать каждое из них?
3.  Для чего нужен конструктор? Что произойдет, если в классе не объявлен ни один конструктор?
4.  Может ли класс иметь несколько конструкторов? Если да, то как это называется и для чего используется? ( *Подсказка: Это называется "перегрузка конструкторов"* ).
5.  В каком порядке выполняются конструкторы при создании объекта производного класса (при наследовании)?
6.  Что такое статический конструктор и когда он выполняется?
7.  Объясните, что делает следующая строка кода, разобрав каждую ее часть:
    `Person student = new Person("Анна") { Age = 20 };`
8.  Какие значения получат поля типа `int`, `string`, `bool` в новом объекте, если их не инициализировать в конструкторе?
9.  Может ли конструктор быть `private`? И если да, то в каких сценариях это может быть полезно? ( *Подсказка: Паттерн "Одиночка" (Singleton)* ).