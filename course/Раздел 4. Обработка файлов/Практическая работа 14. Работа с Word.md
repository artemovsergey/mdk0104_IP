# Практическая работа 14. Работа с Word в .NET

Создание, чтение, редактирование и сохранение документов Microsoft Word (.docx) с использованием .NET (C#) и библиотеки **Open XML SDK**.

## Цель

Научить студентов:

1. Создавать документы Word программно.
2. Добавлять текст, заголовки и таблицы в Word-документ.
3. Читать содержимое Word-документа.
4. Использовать библиотеку Open XML для работы с документами.
5. Реализовывать простые задачи обработки текстов и таблиц в Word.

---

## Теоретическая часть

### 1. Работа с Word в .NET

В .NET для работы с документами Word чаще всего используют библиотеку **Open XML SDK**. Преимущества Open XML:

* Не требуется установка Microsoft Word.
* Позволяет создавать, читать и редактировать `.docx` файлы.
* Подходит для серверной обработки документов.

### 2. Основные классы и методы Open XML SDK

* `WordprocessingDocument` — основной класс документа Word.
* `MainDocumentPart` — основной раздел документа.
* `Body` — тело документа, содержит абзацы и таблицы.
* `Paragraph` — абзац текста.
* `Run` — форматирование текста внутри абзаца.
* `Table` и `TableRow` — таблицы и строки таблицы.

### 3. Основные операции

1. Создание нового документа.
2. Добавление текста и заголовков.
3. Добавление таблиц.
4. Чтение текста из документа.
5. Сохранение документа в файл `.docx`.

---

## Ход работы

1. Установить пакет **DocumentFormat.OpenXml** через NuGet.
2. Создать новый проект C# (.NET Console Application).
3. Создать Word-документ программно или открыть существующий.
4. Добавить текст, заголовки и/или таблицы.
5. Сохранить документ.
6. Прочитать содержимое документа и вывести его в консоль.
7. Сделать скриншоты работы программы и положить их в папку `images`.
8. Подготовить `readme.md` с номером работы, вариантом, текстом задания и кодом с подсветкой.

---

## Практический пример

Пример создания Word-документа с заголовком и абзацем:

```csharp
using DocumentFormat.OpenXml.Packaging;
using DocumentFormat.OpenXml.Wordprocessing;

class Program
{
    static void Main()
    {
        string filepath = "Example.docx";

        using (WordprocessingDocument wordDoc = WordprocessingDocument.Create(filepath, DocumentFormat.OpenXml.WordprocessingDocumentType.Document))
        {
            MainDocumentPart mainPart = wordDoc.AddMainDocumentPart();
            mainPart.Document = new Document();
            Body body = mainPart.Document.AppendChild(new Body());

            // Добавляем заголовок
            Paragraph heading = new Paragraph(new Run(new Text("Заголовок документа")));
            body.AppendChild(heading);

            // Добавляем абзац текста
            Paragraph paragraph = new Paragraph(new Run(new Text("Пример текста в Word-документе.")));
            body.AppendChild(paragraph);
        }

        Console.WriteLine("Документ Example.docx создан.");
    }
}
```

---

## 15 вариантов простых заданий

Вариант выбирается по номеру в журнале:

1. Создать Word-документ с заголовком и одним абзацем.
2. Создать Word-документ с двумя абзацами текста.
3. Добавить таблицу 3x3 в Word-документ.
4. Прочитать текст из существующего документа и вывести в консоль.
5. Добавить заголовок и подзаголовок в документ.
6. Сформировать документ с списком маркеров (буллетов).
7. Добавить нумерованный список в документ.
8. Создать таблицу с именами и возрастом (3 строки, 2 колонки).
9. Найти и заменить текст в существующем документе.
10. Добавить новый абзац в существующий документ.
11. Создать документ с текстом разного форматирования (жирный, курсив, подчеркнутый).
12. Создать документ и сохранить его копию с другим именем.
13. Прочитать все таблицы документа и вывести содержимое в консоль.
14. Сгенерировать документ Word с текущей датой и временем.
15. Создать документ с текстом и вставить пустую строку между абзацами.

---

## Критерии оценки

| Оценка | Критерий                                                                                                                                                                                             |
| ------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 2      | Программа создаёт Word-документ, но не выполняет полностью задание.                                                                                                                                  |
| 3      | Программа работает корректно, создаёт документ с текстом/таблицами, возможны мелкие ошибки форматирования.                                                                                           |
| 4      | Программа полностью выполняет задание, документ корректно отображается, код читаем и комментирован.                                                                                                  |
| 5      | Программа полностью выполняет задание, использованы расширенные возможности Open XML (таблицы, форматирование), код структурирован, добавлены проверки, скриншоты и `readme.md` оформлены корректно. |

---

## Контрольные вопросы

1. Чем отличается Open XML SDK от автоматизации через Microsoft.Office.Interop.Word?
2. Какие классы Open XML отвечают за текст и абзацы?
3. Как добавить таблицу в документ Word?
4. Как прочитать содержимое Word-документа?
5. Как сохранить документ с другим именем?
6. Какие преимущества использования Open XML на сервере?
7. Как добавить заголовок и подзаголовок в документ?
8. Как создать нумерованный или маркерованный список в Word через Open XML?

---

## Структура репозитория

```
Практическая_работа_14/
├─ WordApp/                   # Проект C# (.NET Console Application)
│   ├─ Program.cs
│   ├─ Example.docx            # Созданный документ
│   └─ ... (другие файлы проекта)
├─ images/                     # Скриншоты работы программы
│   ├─ screenshot1.png
│   └─ screenshot2.png
└─ readme.md                   # Описание работы
```

---

## Содержание файла `readme.md` (пример)

````markdown
# Практическая работа 14
## Работа с Word
### Вариант: 5
**Задание:** Добавить заголовок и подзаголовок в Word-документ, сохранить результат.

### Пример кода:

```csharp
using DocumentFormat.OpenXml.Packaging;
using DocumentFormat.OpenXml.Wordprocessing;

class Program
{
    static void Main()
    {
        string filepath = "Example.docx";

        using (WordprocessingDocument wordDoc = WordprocessingDocument.Create(filepath, DocumentFormat.OpenXml.WordprocessingDocumentType.Document))
        {
            MainDocumentPart mainPart = wordDoc.AddMainDocumentPart();
            mainPart.Document = new Document();
            Body body = mainPart.Document.AppendChild(new Body());

            // Заголовок
            Paragraph heading = new Paragraph(new Run(new Text("Заголовок документа")));
            body.AppendChild(heading);

            // Подзаголовок
            Paragraph subheading = new Paragraph(new Run(new Text("Подзаголовок документа")));
            body.AppendChild(subheading);
        }

        Console.WriteLine("Документ Example.docx создан.");
    }
}
````

```