# Практическая работа 15. Работа с Excel в .NET

Создание, чтение и редактирование документов Microsoft Excel (.xlsx) с использованием .NET (C#) и библиотеки **EPPlus**.

## Цель

Научить студентов:

1. Создавать Excel-документы программно.
2. Заполнять таблицы данными.
3. Читать данные из существующих файлов Excel.
4. Форматировать ячейки и работать с листами.
5. Реализовывать простые задачи обработки данных в Excel.

---

## Теоретическая часть

### 1. Работа с Excel в .NET

Для работы с Excel в .NET часто используют библиотеку **EPPlus**, которая позволяет:

* Создавать и редактировать `.xlsx` файлы.
* Работать с листами, ячейками, таблицами.
* Форматировать ячейки: шрифт, цвет, выравнивание.
* Чтение и запись данных без установки Microsoft Excel.

### 2. Основные классы и методы EPPlus

* `ExcelPackage` — основной класс для работы с Excel-файлом.
* `ExcelWorkbook` — рабочая книга.
* `ExcelWorksheet` — лист Excel.
* `Cells[row, col]` — доступ к ячейкам.

### 3. Основные операции

1. Создание нового документа Excel.
2. Добавление листа.
3. Запись и чтение данных в ячейки.
4. Форматирование ячеек.
5. Сохранение документа.

---

## Ход работы

1. Установить пакет **EPPlus** через NuGet.
2. Создать новый проект C# (.NET Console Application).
3. Создать Excel-документ программно или открыть существующий.
4. Добавить данные в таблицы (числа, текст).
5. Отформатировать ячейки по необходимости.
6. Сохранить файл.
7. Прочитать данные из файла и вывести в консоль.
8. Сделать скриншоты работы программы и положить их в папку `images`.
9. Подготовить `readme.md` с номером работы, вариантом, текстом задания и кодом с подсветкой.

---

## Практический пример

Пример создания Excel-файла с таблицей:

```csharp
using System;
using System.IO;
using OfficeOpenXml;

class Program
{
    static void Main()
    {
        string filePath = "Example.xlsx";
        ExcelPackage.LicenseContext = LicenseContext.NonCommercial;

        using (ExcelPackage package = new ExcelPackage())
        {
            var worksheet = package.Workbook.Worksheets.Add("Лист1");

            // Заголовки
            worksheet.Cells[1, 1].Value = "Имя";
            worksheet.Cells[1, 2].Value = "Возраст";

            // Данные
            worksheet.Cells[2, 1].Value = "Иван";
            worksheet.Cells[2, 2].Value = 25;
            worksheet.Cells[3, 1].Value = "Мария";
            worksheet.Cells[3, 2].Value = 30;

            package.SaveAs(new FileInfo(filePath));
        }

        Console.WriteLine("Excel-файл Example.xlsx создан.");
    }
}
```

---

## 15 вариантов простых заданий

Вариант выбирается по номеру в журнале:

1. Создать Excel-файл с одной таблицей и заголовками.
2. Создать Excel-файл с двумя листами и таблицами на каждом.
3. Добавить данные о студентах: имя, возраст, группа.
4. Прочитать данные из существующего Excel-файла и вывести в консоль.
5. Вычислить средний возраст студентов и записать результат в файл.
6. Отформатировать заголовки (жирный шрифт, выравнивание по центру).
7. Добавить формулы (например, суммирование чисел в столбце).
8. Создать таблицу с оценками и вычислить средний балл для каждого студента.
9. Добавить новый лист и перенести туда данные из другого листа.
10. Найти максимальное и минимальное значение в столбце и записать результат.
11. Сортировать данные по имени или возрасту.
12. Подсчитать количество строк с определенным значением в столбце.
13. Создать диаграмму на основе данных таблицы (по желанию).
14. Объединить несколько ячеек для заголовка.
15. Сохранить Excel-файл с другим именем и открыть его для проверки.

---

## Критерии оценки

| Оценка | Критерий                                                                                                                                                                                                             |
| ------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 2      | Программа создаёт Excel-файл, но не выполняет полностью задание.                                                                                                                                                     |
| 3      | Программа работает корректно, создаёт таблицы, возможны мелкие ошибки форматирования.                                                                                                                                |
| 4      | Программа полностью выполняет задание, таблицы и листы корректны, код читаем и комментирован.                                                                                                                        |
| 5      | Программа полностью выполняет задание, использованы расширенные возможности EPPlus (формулы, форматирование, несколько листов), код структурирован, добавлены проверки, скриншоты и `readme.md` оформлены корректно. |

---

## Контрольные вопросы

1. Как создать новый Excel-файл с помощью EPPlus?
2. Как добавить новый лист в книгу Excel?
3. Как записать текст или число в конкретную ячейку?
4. Как считать данные из Excel-файла?
5. Как применить форматирование к ячейке (жирный шрифт, выравнивание)?
6. Как сохранить Excel-файл под другим именем?
7. Как использовать формулы в EPPlus?
8. Как подсчитать среднее значение в столбце Excel через код?

---

## Структура репозитория

```
Практическая_работа_15/
├─ ExcelApp/                   # Проект C# (.NET Console Application)
│   ├─ Program.cs
│   ├─ Example.xlsx            # Созданный Excel-файл
│   └─ ... (другие файлы проекта)
├─ images/                     # Скриншоты работы программы
│   ├─ screenshot1.png
│   └─ screenshot2.png
└─ readme.md                   # Описание работы
```

---

## Содержание файла `readme.md` (пример)

````markdown
# Практическая работа 15
## Работа с Excel
### Вариант: 4
**Задание:** Прочитать данные из существующего Excel-файла и вывести их в консоль.

### Пример кода:

```csharp
using System;
using System.IO;
using OfficeOpenXml;

class Program
{
    static void Main()
    {
        string filePath = "Example.xlsx";
        ExcelPackage.LicenseContext = LicenseContext.NonCommercial;

        if (!File.Exists(filePath))
        {
            Console.WriteLine("Файл Example.xlsx не найден.");
            return;
        }

        using (ExcelPackage package = new ExcelPackage(new FileInfo(filePath)))
        {
            var worksheet = package.Workbook.Worksheets[0];
            int rowCount = worksheet.Dimension.Rows;
            int colCount = worksheet.Dimension.Columns;

            for (int row = 1; row <= rowCount; row++)
            {
                for (int col = 1; col <= colCount; col++)
                {
                    Console.Write($"{worksheet.Cells[row, col].Text}\t");
                }
                Console.WriteLine();
            }
        }
    }
}
````

```