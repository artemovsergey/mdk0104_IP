# Практическая работа 16. Работа с PDF в .NET

Создание, чтение и редактирование PDF-документов с использованием .NET (C#) и библиотеки **iText7** или **PdfSharp**.

## Цель

Научить студентов:

1. Создавать PDF-документы программно.
2. Добавлять текст, заголовки, таблицы и изображения в PDF.
3. Читать содержимое PDF-документа.
4. Форматировать текст и элементы PDF.
5. Решать практические задачи обработки PDF-документов.

---

## Теоретическая часть

### 1. Работа с PDF в .NET

В .NET для работы с PDF применяются библиотеки:

* **iText7** (платная и бесплатная версия AGPL) — мощная библиотека для создания и редактирования PDF.
* **PdfSharp** — бесплатная библиотека для создания и редактирования PDF-документов.

Возможности:

* Создание PDF с текстом, таблицами, списками.
* Добавление изображений и ссылок.
* Форматирование текста: шрифт, размер, цвет, выравнивание.
* Чтение содержимого PDF (только iText7 обеспечивает удобное извлечение текста).

### 2. Основные классы и методы iText7

* `PdfWriter` — записывает PDF в файл.
* `PdfDocument` — основной документ.
* `Document` — представляет тело документа.
* `Paragraph` — абзац текста.
* `Table` и `Cell` — таблицы и ячейки таблицы.

---

## Ход работы

1. Установить пакет **iText7** через NuGet:

   ```
   Install-Package itext7
   ```
2. Создать новый проект C# (.NET Console Application).
3. Создать PDF-документ программно или открыть существующий.
4. Добавить текст, заголовки, таблицы и изображения.
5. Сохранить PDF.
6. Прочитать текст из PDF (по возможности).
7. Сделать скриншоты работы программы и положить их в папку `images`.
8. Подготовить `readme.md` с номером работы, вариантом, текстом задания и кодом с подсветкой.

---

## Практический пример

Пример создания PDF-документа с заголовком и абзацем:

```csharp
using System;
using iText.Kernel.Pdf;
using iText.Layout;
using iText.Layout.Element;

class Program
{
    static void Main()
    {
        string filePath = "Example.pdf";

        using (PdfWriter writer = new PdfWriter(filePath))
        using (PdfDocument pdf = new PdfDocument(writer))
        using (Document document = new Document(pdf))
        {
            // Заголовок
            Paragraph heading = new Paragraph("Заголовок PDF-документа")
                .SetFontSize(18)
                .SetBold();
            document.Add(heading);

            // Абзац текста
            Paragraph paragraph = new Paragraph("Пример текста в PDF-документе.");
            document.Add(paragraph);
        }

        Console.WriteLine("PDF-документ Example.pdf создан.");
    }
}
```

---

## 15 вариантов простых заданий

Вариант выбирается по номеру в журнале:

1. Создать PDF с заголовком и одним абзацем текста.
2. Создать PDF с двумя абзацами текста.
3. Добавить таблицу 3x3 в PDF.
4. Прочитать текст из существующего PDF и вывести в консоль.
5. Добавить заголовок и подзаголовок.
6. Создать PDF с маркерованным списком.
7. Создать PDF с нумерованным списком.
8. Создать таблицу с данными студентов: имя, возраст, группа.
9. Найти и заменить текст в PDF (только для iText7).
10. Добавить новый абзац в существующий PDF.
11. Создать PDF с текстом разного форматирования (жирный, курсив, подчеркнутый).
12. Создать PDF с изображением (например, логотип).
13. Создать PDF с текущей датой и временем.
14. Объединить несколько PDF в один файл.
15. Сохранить PDF под другим именем и открыть его для проверки.

---

## Критерии оценки

| Оценка | Критерий                                                                                                                                                                                                        |
| ------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 2      | Программа создаёт PDF, но не выполняет полностью задание.                                                                                                                                                       |
| 3      | Программа работает корректно, создаёт текст или таблицы, возможны мелкие ошибки форматирования.                                                                                                                 |
| 4      | Программа полностью выполняет задание, текст и таблицы корректны, код читаем и комментирован.                                                                                                                   |
| 5      | Программа полностью выполняет задание, использованы расширенные возможности iText7 (форматирование, таблицы, изображения), код структурирован, добавлены проверки, скриншоты и `readme.md` оформлены корректно. |

---

## Контрольные вопросы

1. Какие библиотеки .NET можно использовать для работы с PDF?
2. Как создать новый PDF-документ?
3. Как добавить заголовок и абзац текста в PDF?
4. Как создать таблицу в PDF-документе?
5. Как добавить изображение в PDF?
6. Как прочитать текст из PDF?
7. Как сохранить PDF под другим именем?
8. Как объединить несколько PDF-файлов в один?

---

## Структура репозитория

```
Практическая_работа_16/
├─ PdfApp/                    # Проект C# (.NET Console Application)
│   ├─ Program.cs
│   ├─ Example.pdf             # Созданный PDF-документ
│   └─ ... (другие файлы проекта)
├─ images/                     # Скриншоты работы программы
│   ├─ screenshot1.png
│   └─ screenshot2.png
└─ readme.md                   # Описание работы
```

---

## Содержание файла `readme.md` (пример)

````markdown
# Практическая работа 16
## Работа с PDF
### Вариант: 3
**Задание:** Добавить таблицу 3x3 в PDF-документ.

### Пример кода:

```csharp
using System;
using iText.Kernel.Pdf;
using iText.Layout;
using iText.Layout.Element;

class Program
{
    static void Main()
    {
        string filePath = "Example.pdf";

        using (PdfWriter writer = new PdfWriter(filePath))
        using (PdfDocument pdf = new PdfDocument(writer))
        using (Document document = new Document(pdf))
        {
            // Заголовок
            Paragraph heading = new Paragraph("Таблица в PDF")
                .SetFontSize(16)
                .SetBold();
            document.Add(heading);

            // Таблица 3x3
            Table table = new Table(3);
            for (int i = 1; i <= 9; i++)
            {
                table.AddCell($"Ячейка {i}");
            }
            document.Add(table);
        }

        Console.WriteLine("PDF-документ Example.pdf создан.");
    }
}
````

```