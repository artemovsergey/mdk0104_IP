# Практическая работа 21. CRUD-операции с Entity Framework

Реализация **CRUD-операций (Create, Read, Update, Delete)** с использованием **Entity Framework Core** в проектах .NET.

### Цель:

* Изучить базовые операции с данными через EF Core.
* Научиться создавать, читать, обновлять и удалять записи в базе данных.
* Закрепить практические навыки работы с моделями данных и DbContext.

---

## Теоретическая часть

### 1. CRUD-операции

CRUD — это базовые операции с данными:

| Операция | Описание                            |
| -------- | ----------------------------------- |
| Create   | Создание новой записи в базе данных |
| Read     | Чтение существующих записей         |
| Update   | Обновление существующих записей     |
| Delete   | Удаление записей из базы данных     |

### 2. Реализация CRUD в EF Core

Все операции выполняются через **DbContext** и **DbSet<TEntity>**.

* **Create** — добавление новой сущности:

```csharp
context.Products.Add(product);
context.SaveChanges();
```

* **Read** — чтение данных:

```csharp
var products = context.Products.ToList();
var product = context.Products.FirstOrDefault(p => p.Id == 1);
```

* **Update** — обновление данных:

```csharp
product.Price = 2000;
context.Products.Update(product);
context.SaveChanges();
```

* **Delete** — удаление данных:

```csharp
context.Products.Remove(product);
context.SaveChanges();
```

### 3. Особенности работы с EF Core

* **Отслеживание изменений (Change Tracking)** автоматически фиксирует изменения сущностей.
* Для операций только чтения можно использовать `AsNoTracking()` для повышения производительности.
* CRUD-операции можно комбинировать с LINQ-запросами для фильтрации, сортировки и проекции данных.

---

## Ход работы

1. Выбрать вариант задания по номеру в журнале.
2. Создать проект .NET (консольное, WinForms или ASP.NET Core).
3. Создать модели данных и DbContext.
4. Реализовать CRUD-операции для выбранной сущности.
5. Сделать тестовые записи и проверить корректность операций.
6. Сделать скриншоты работы программы и положить их в папку `images`.
7. Создать файл `readme.md` с номером практической работы, вариантом, текстом задания и оформленным кодом.
8. Сохранить проект в репозиторий.

---

## Практический пример

**1. Модель сущности `Product`:**

```csharp
public class Product
{
    public int Id { get; set; }
    public string Name { get; set; }
    public decimal Price { get; set; }
}
```

**2. DbContext:**

```csharp
public class ShopContext : DbContext
{
    public DbSet<Product> Products { get; set; }

    protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
    {
        optionsBuilder.UseSqlServer("Server=.;Database=ShopDb;Trusted_Connection=True;");
    }
}
```

**3. CRUD-операции:**

```csharp
using var context = new ShopContext();

// CREATE
var product = new Product { Name = "Laptop", Price = 1500 };
context.Products.Add(product);
context.SaveChanges();

// READ
var allProducts = context.Products.ToList();
var singleProduct = context.Products.FirstOrDefault(p => p.Id == 1);

// UPDATE
singleProduct.Price = 1400;
context.Products.Update(singleProduct);
context.SaveChanges();

// DELETE
context.Products.Remove(singleProduct);
context.SaveChanges();
```

---

## 15 вариантов заданий

1. Создать CRUD-операции для сущности `Product` (Id, Name, Price).
2. CRUD для `Customer` (Id, FullName, Email).
3. CRUD для `Order` (Id, CustomerId, OrderDate).
4. CRUD для `Student` (Id, Name, Age).
5. CRUD для `Teacher` (Id, Name, Subject).
6. CRUD для `Course` (Id, Title, Description).
7. CRUD для `Invoice` (Id, InvoiceNumber, Amount).
8. CRUD для `Library` (Id, Name, Address).
9. CRUD для `Book` (Id, Title, Author).
10. CRUD для `Employee` (Id, Name, Salary).
11. CRUD для `Department` (Id, Name).
12. CRUD для `Project` (Id, Name, StartDate).
13. CRUD для `User` (Id, Username, Password).
14. CRUD для `Profile` (Id, Bio, UserId).
15. CRUD для `ProductCategory` (Id, Name).

---

## Критерии оценки

| Оценка | Критерий                                                                                 |
| ------ | ---------------------------------------------------------------------------------------- |
| 5      | Полное выполнение задания, все CRUD-операции работают корректно, есть скриншоты и readme |
| 4      | Все CRUD выполнены, но с небольшими недочетами, есть скриншоты и readme                  |
| 3      | CRUD выполнены частично, есть ошибки, либо отсутствуют скриншоты/readme                  |
| 2      | Работа выполнена частично, CRUD не работает, отсутствуют скриншоты/readme                |
| 1      | Работа не сдана или проект не запускается                                                |

---

## Контрольные вопросы

1. Какие операции входят в CRUD и что они делают?
2. Как создать новую запись в EF Core?
3. Как получить список всех записей из таблицы?
4. Как обновить данные сущности?
5. Как удалить запись из базы данных?
6. Что такое `AsNoTracking()` и когда его использовать?
7. Чем отличается метод `Find` от `FirstOrDefault`?
8. Как объединять CRUD-операции с LINQ-запросами?
9. Какие типы данных лучше использовать для ключей сущностей?
10. Какие файлы должны быть включены в репозиторий при сдаче работы?

---

## Структура репозитория

```
ПрактическаяРабота21/
│
├─ Project/                  # Проект приложения (ConsoleApp, WinForms, ASP.NET Core)
│
├─ images/                   # Скриншоты работы программы
│
└─ readme.md                 # Номер работы, вариант, текст задания, пример кода
```

**Пример readme.md:**

````markdown
# Практическая работа №21
## Тема: CRUD-операции с EF
### Вариант 3

**Задание:** Создать CRUD-операции для сущности `Student` с полями Id, Name, Age.

```csharp
public class Student
{
    public int Id { get; set; }
    public string Name { get; set; }
    public int Age { get; set; }
}
````

```csharp
using var context = new AppDbContext();
var student = new Student { Name = "John", Age = 20 };
context.Students.Add(student);
context.SaveChanges();
```

```